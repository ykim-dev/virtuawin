<html>
<head>
<title>External Interface</title>
<meta name="Author" content="Steven Phillips">
<meta name="Generator" content="MicroEmacs JST">
</head>
<body>
<p>   </p>

<p><h2>External Interface </h2></p>

<p>Most VirtuaWin commands and features can be accessed by sending windows messages to the <span style="font-family: monospace">VirtuaWinMainClass</span> window, this is also known as the Module interface. Any external program can locate this VirtuaWin window and send it commands, or use VirtuaWin's <b>-msg</b> command-line option, the format of this option is as follows:</p>

<dir><p><span style="font-family: monospace">VirtuaWin.exe -msg &lt;Msg&gt; &lt;wParam&gt; &lt;lParam&gt;</span></p>

</dir><p>Where <span style="font-family: monospace">&lt;Msg&gt;</span>, <span style="font-family: monospace">&lt;wParam&gt;</span> and <span style="font-family: monospace">&lt;lParam&gt;</span> are numbers as per the standard Windows SendMessage function. A complete and up-to-date list of supported messages can be found in Messages.h in the SDK package, the following list may not be fully up-to-date:</p>

<dir><table border=1 cellpadding=4 cellspacing=0>

<tr><td valign="top">
<p><b>Msg</b></p></td>
<td valign="top">
<p><b>wParam</b></p></td>
<td valign="top">
<p><b>lParam</b></p></td>
<td valign="top">
<p><b>Description</b></p></td></tr>
<tr><td valign="top">
<p>1034</p></td>
<td valign="top">
<p>#</p></td>
<td valign="top">
<p>-</p></td>
<td valign="top">
<p>Change to desktop #.</p></td></tr>
<tr><td valign="top">
<p>1034</p></td>
<td valign="top">
<p>1025</p></td>
<td valign="top">
<p>-</p></td>
<td valign="top">
<p>Change to previous desktop.</p></td></tr>
<tr><td valign="top">
<p>1034</p></td>
<td valign="top">
<p>1026</p></td>
<td valign="top">
<p>-</p></td>
<td valign="top">
<p>Change to next desktop.</p></td></tr>
<tr><td valign="top">
<p>1034</p></td>
<td valign="top">
<p>1035</p></td>
<td valign="top">
<p>-</p></td>
<td valign="top">
<p>Change to next desktop to the left.</p></td></tr>
<tr><td valign="top">
<p>1034</p></td>
<td valign="top">
<p>1036</p></td>
<td valign="top">
<p>-</p></td>
<td valign="top">
<p>Change to next desktop to the right.</p></td></tr>
<tr><td valign="top">
<p>1034</p></td>
<td valign="top">
<p>1037</p></td>
<td valign="top">
<p>-</p></td>
<td valign="top">
<p>Change to next desktop above.</p></td></tr>
<tr><td valign="top">
<p>1034</p></td>
<td valign="top">
<p>1038</p></td>
<td valign="top">
<p>-</p></td>
<td valign="top">
<p>Change to next desktop below.</p></td></tr>
<tr><td valign="top">
<p>1039</p></td>
<td valign="top">
<p>-</p></td>
<td valign="top">
<p>-</p></td>
<td valign="top">
<p>Exit VirtuaWin.</p></td></tr>
<tr><td valign="top">
<p>1040</p></td>
<td valign="top">
<p>-</p></td>
<td valign="top">
<p>-</p></td>
<td valign="top">
<p>Open Setup dialog.</p></td></tr>
<tr><td valign="top">
<p>1041</p></td>
<td valign="top">
<p>-</p></td>
<td valign="top">
<p>-</p></td>
<td valign="top">
<p>Remove VirtuaWin's systray icon. </p></td></tr>
<tr><td valign="top">
<p>1042</p></td>
<td valign="top">
<p>-</p></td>
<td valign="top">
<p>-</p></td>
<td valign="top">
<p>Show VirtuaWin's systray icon. </p></td></tr>
<tr><td valign="top">
<p>1043</p></td>
<td valign="top">
<p>-</p></td>
<td valign="top">
<p>-</p></td>
<td valign="top">
<p>Open VirtuaWin's on-line help. </p></td></tr>
<tr><td valign="top">
<p>1044</p></td>
<td valign="top">
<p>-</p></td>
<td valign="top">
<p>-</p></td>
<td valign="top">
<p>Gather all windows onto the current desktop.</p></td></tr>
<tr><td valign="top">
<p>1045</p></td>
<td valign="top">
<p>-</p></td>
<td valign="top">
<p>-</p></td>
<td valign="top">
<p>Returns the width of the current layout, i.e. how many desktops wide.</p></td></tr>
<tr><td valign="top">
<p>1046</p></td>
<td valign="top">
<p>-</p></td>
<td valign="top">
<p>-</p></td>
<td valign="top">
<p>Returns the depth of the current layout, i.e. how many desktops deep.</p></td></tr>
<tr><td valign="top">
<p>1048</p></td>
<td valign="top">
<p>-</p></td>
<td valign="top">
<p>-</p></td>
<td valign="top">
<p>Returns the current desktop number.</p></td></tr>
<tr><td valign="top">
<p>1049</p></td>
<td valign="top">
<p>hWnd or 0</p></td>
<td valign="top">
<p>#</p></td>
<td valign="top">
<p>Move window to desktop #.</p></td></tr>
<tr><td valign="top">
<p>1049</p></td>
<td valign="top">
<p>hWnd or 0</p></td>
<td valign="top">
<p>1025</p></td>
<td valign="top">
<p>Move window to previous desktop.</p></td></tr>
<tr><td valign="top">
<p>1049</p></td>
<td valign="top">
<p>hWnd or 0</p></td>
<td valign="top">
<p>1026</p></td>
<td valign="top">
<p>Move window to next desktop.</p></td></tr>
<tr><td valign="top">
<p>1049</p></td>
<td valign="top">
<p>hWnd or 0</p></td>
<td valign="top">
<p>1035</p></td>
<td valign="top">
<p>Move window to next desktop to the left.</p></td></tr>
<tr><td valign="top">
<p>1049</p></td>
<td valign="top">
<p>hWnd or 0</p></td>
<td valign="top">
<p>1036</p></td>
<td valign="top">
<p>Move window to next desktop to the right.</p></td></tr>
<tr><td valign="top">
<p>1049</p></td>
<td valign="top">
<p>hWnd or 0</p></td>
<td valign="top">
<p>1037</p></td>
<td valign="top">
<p>Move window to next desktop above.</p></td></tr>
<tr><td valign="top">
<p>1049</p></td>
<td valign="top">
<p>hWnd or 0</p></td>
<td valign="top">
<p>1038</p></td>
<td valign="top">
<p>Move window to next desktop below.</p></td></tr>
<tr><td valign="top">
<p>1049</p></td>
<td valign="top">
<p>hWnd or 0</p></td>
<td valign="top">
<p>-#, -1025, ...</p></td>
<td valign="top">
<p>As with positive lParam values only VirtuaWin changes desktops as well, i.e. moves window and follows.</p></td></tr>
<tr><td valign="top">
<p>1050</p></td>
<td valign="top">
<p>hWnd or 0</p></td>
<td valign="top">
<p>-1</p></td>
<td valign="top">
<p>Toggle whether the window is shown on all desktops.</p></td></tr>
<tr><td valign="top">
<p>1050</p></td>
<td valign="top">
<p>hWnd or 0</p></td>
<td valign="top">
<p>0</p></td>
<td valign="top">
<p>Do not show window on all desktops.</p></td></tr>
<tr><td valign="top">
<p>1050</p></td>
<td valign="top">
<p>hWnd or 0</p></td>
<td valign="top">
<p>1</p></td>
<td valign="top">
<p>Show window on all desktops.</p></td></tr>
<tr><td valign="top">
<p>1051</p></td>
<td valign="top">
<p>hWnd</p></td>
<td valign="top">
<p>0</p></td>
<td valign="top">
<p>Give the window the focus, i.e. make it the foreground window.</p></td></tr>
<tr><td valign="top">
<p>1051</p></td>
<td valign="top">
<p>0</p></td>
<td valign="top">
<p>0</p></td>
<td valign="top">
<p>Get VirtuaWin to select the best window to give the current focus to.</p></td></tr>
<tr><td valign="top">
<p>1051</p></td>
<td valign="top">
<p>hWnd</p></td>
<td valign="top">
<p>#</p></td>
<td valign="top">
<p>Give the window the focus for the given desktop, i.e. sets the z-order so the window will be given the focus when next on that desktop.</p></td></tr>
<tr><td valign="top">
<p>1052</p></td>
<td valign="top">
<p>hWnd</p></td>
<td valign="top">
<p>-</p></td>
<td valign="top">
<p>Send the VirtuaWin installation path to <span style="font-family: monospace">hWnd</span> via a WM_COPYDATA message.</p></td></tr>
<tr><td valign="top">
<p>1053</p></td>
<td valign="top">
<p>hWnd</p></td>
<td valign="top">
<p>-</p></td>
<td valign="top">
<p>Send the VirtuaWin user configuration path to <span style="font-family: monospace">hWnd</span> via a WM_COPYDATA message.</p></td></tr>
<tr><td valign="top">
<p>1063</p></td>
<td valign="top">
<p>hWnd</p></td>
<td valign="top">
<p>0</p></td>
<td valign="top">
<p>Access window - use method defined by 'On hidden window activation' setting.</p></td></tr>
<tr><td valign="top">
<p>1063</p></td>
<td valign="top">
<p>hWnd</p></td>
<td valign="top">
<p>1</p></td>
<td valign="top">
<p>Access window - move to the current desktop.</p></td></tr>
<tr><td valign="top">
<p>1063</p></td>
<td valign="top">
<p>hWnd</p></td>
<td valign="top">
<p>2</p></td>
<td valign="top">
<p>Access window - shown on the current desktop.</p></td></tr>
<tr><td valign="top">
<p>1063</p></td>
<td valign="top">
<p>hWnd</p></td>
<td valign="top">
<p>3</p></td>
<td valign="top">
<p>Access window - change to the window's desktop.</p></td></tr>
<tr><td valign="top">
<p>1063</p></td>
<td valign="top">
<p>hWnd</p></td>
<td valign="top">
<p>-1</p></td>
<td valign="top">
<p>Use window's 'On hidden window activation' setting (if set to ignore nothing will happen).</p></td></tr>
<tr><td valign="top">
<p>1064</p></td>
<td valign="top">
<p>hWnd</p></td>
<td valign="top">
<p>-</p></td>
<td valign="top">
<p>Returns information about the window, see Messages.h for more information.</p></td></tr>
<tr><td valign="top">
<p>1065</p></td>
<td valign="top">
<p>?</p></td>
<td valign="top">
<p>?</p></td>
<td valign="top">
<p>Controls desktop thumbnail image generation, see Messages.h for more information.</p></td></tr>
<tr><td valign="top">
<p>1066</p></td>
<td valign="top">
<p>0</p></td>
<td valign="top">
<p>-</p></td>
<td valign="top">
<p>Returns the current VirtuaWin running state (0 = disabled, 1 = enabled).</p></td></tr>
<tr><td valign="top">
<p>1066</p></td>
<td valign="top">
<p>1</p></td>
<td valign="top">
<p>-</p></td>
<td valign="top">
<p>Toggles the current VirtuaWin running state, returns the previous state.</p></td></tr>
<tr><td valign="top">
<p>1066</p></td>
<td valign="top">
<p>2</p></td>
<td valign="top">
<p>-</p></td>
<td valign="top">
<p>Disables VirtuaWin, returns the previous running state.</p></td></tr>
<tr><td valign="top">
<p>1066</p></td>
<td valign="top">
<p>3</p></td>
<td valign="top">
<p>-</p></td>
<td valign="top">
<p>Enables VirtuaWin, returns the previous running state.</p></td></tr>
<tr><td valign="top">
<p>1067</p></td>
<td valign="top">
<p>hWnd</p></td>
<td valign="top">
<p>#</p></td>
<td valign="top">
<p>Send the name of desktop # (or current desktop if # = 0) to <span style="font-family: monospace">hWnd</span> via a WM_COPYDATA message.</p></td></tr>
<tr><td valign="top">
<p>1068</p></td>
<td valign="top">
<p>-</p></td>
<td valign="top">
<p>-</p></td>
<td valign="top">
<p>Returns the largest possible desktop number.</p></td></tr>
<tr><td valign="top">
<p>1069</p></td>
<td valign="top">
<p>hWnd or 0</p></td>
<td valign="top">
<p>0</p></td>
<td valign="top">
<p>Force VirtuaWin to NOT manage the given window. <b>Note</b>: VirtuaWin will remember this setting for the lifespan of the window, only a 'manage window' message (see below) can change this.</p></td></tr>
<tr><td valign="top">
<p>1069</p></td>
<td valign="top">
<p>hWnd or 0</p></td>
<td valign="top">
<p>1</p></td>
<td valign="top">
<p>Force VirtuaWin to manage the given window.</p></td></tr>
<tr><td valign="top">
<p>1070</p></td>
<td valign="top">
<p>cmd-id</p></td>
<td valign="top">
<p>?</p></td>
<td valign="top">
<p>Execute hotkey command <i>cmd-id</i> (see second column in vwCommands.def) as if the user pressed the hotkey. The lParam value is split into to parts, the lower 16 bits (LOWORD(lParam)) is the desktop number (if required but the hotkey command) and the higher 16 bits (HIWORD(lParam)) is the modifier, only bit vwHOTKEY_WIN_MOUSE is used.</p></td></tr>
<tr><td valign="top">
<p>1071</p></td>
<td valign="top">
<p>hWnd</p></td>
<td valign="top">
<p>0</p></td>
<td valign="top">
<p>Remove all items added to the control menu, use WM_COPYDATA to add items, see feature request 2980468 for more information and examples.</p></td></tr>
<tr><td valign="top">
<p>1071</p></td>
<td valign="top">
<p>hWnd</p></td>
<td valign="top">
<p>#</p></td>
<td valign="top">
<p>Remove added item # from the control menu.</p></td></tr>
<tr><td valign="top">
<p>1072</p></td>
<td valign="top">
<p>0</p></td>
<td valign="top">
<p>-</p></td>
<td valign="top">
<p>Get the handle of the current module handling desktop changes.</p></td></tr>
<tr><td valign="top">
<p>1072</p></td>
<td valign="top">
<p>1</p></td>
<td valign="top">
<p>hWnd</p></td>
<td valign="top">
<p>Set the handle of the module handling desktop changes, returns 2 if successful, 1 otherwise.</p></td></tr>
<tr><td valign="top">
<p>1072</p></td>
<td valign="top">
<p>2</p></td>
<td valign="top">
<p>hWnd</p></td>
<td valign="top">
<p>Unsets the current desktop change handling module.</p></td></tr>
<tr><td valign="top">
<p>1072</p></td>
<td valign="top">
<p>3</p></td>
<td valign="top">
<p>-</p></td>
<td valign="top">
<p>Execute the desktop change - only sent but the module controlling desktop changing. See Messages.h for more information.</p></td></tr>
<tr><td valign="top">
<p>1073</p></td>
<td valign="top">
<p>-</p></td>
<td valign="top">
<p>-</p></td>
<td valign="top">
<p>Re-initialize all windows visible on the current desktop, applying all window rules appropriately. Window settings like 'Always show' will be reset.</p></td></tr>
<tr><td valign="top">
<p>1074</p></td>
<td valign="top">
<p>-</p></td>
<td valign="top">
<p>-</p></td>
<td valign="top">
<p>Return current Inervt Up/Down setting, Re-initialize all windows visible on the current desktop, applying all window rules appropriately. Window settings like 'Always show' will be reset.</p></td></tr></table>

</dir><p><b>Where:</b></p>

<dir><table border=0 cellpadding=6 cellspacing=0>

<tr><td valign="top">
<p>-</p></td>
<td valign="top">
<p>means not used (use a 0).</p></td></tr>
<tr><td valign="top">
<p>hWnd</p></td>
<td valign="top">
<p>Numeric handle to the window required.</p></td></tr>
<tr><td valign="top">
<p>hWnd or 0</p></td>
<td valign="top">
<p>Numeric handle to the window required or 0 for the window which currently has the focus.</p></td></tr></table>
</dir></dir>
</body>
</html>
